#!/usr/bin/env bash

IMAGE="your-image-name"
HOME_DIR_ON_HOST="$HOME"
HOME_DIR_IN_CONTAINER="/root"
CONTAINER_NAME="ai-here-copilot"

# Remove old container if exists
if [ "$(docker ps -aq -f name=^/${CONTAINER_NAME}$)" ]; then
  docker rm -f "${CONTAINER_NAME}"
fi

# Get current folder name and set subfolder path in container
SUBFOLDER_NAME="$(basename "$(pwd)")"
CONTAINER_SUBFOLDER="/app/${SUBFOLDER_NAME}"

docker run --rm -it \
  --name "${CONTAINER_NAME}" \
  -e GH_TOKEN \
  -v $HOME_DIR_ON_HOST:$HOME_DIR_IN_CONTAINER \
  -v "$(pwd):${CONTAINER_SUBFOLDER}" \
  -w "${CONTAINER_SUBFOLDER}" \
  "$IMAGE" \
  copilot --allow-all-tools --allow-all-paths
